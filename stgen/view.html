<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>DCA Preview</title>
<style>
body{font-family:Segoe UI;background:#020617;color:#e5e7eb;display:flex;justify-content:center}
.card{max-width:700px;width:100%;margin:40px;background:#020617;border:1px solid #1e293b;border-radius:16px;padding:24px}
.row{margin:6px 0}
.btn{margin-top:12px;padding:12px;border-radius:10px;border:none;cursor:pointer;font-weight:700;width:100%}
.view{background:#2563eb;color:white}
.download{background:#22c55e;color:#022c22}
</style>
</head>

<body>
<div class="card">
<h2>DCA Statement Preview</h2>
<div id="preview"></div>
<button class="btn view" onclick="viewPdf()">View PDF</button>
<button class="btn download" onclick="downloadPdf()">Download PDF</button>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxK_WlIDt48ZuUCp14HUpOPsfcuxQIMoXortxiUphcr6EbAyArqXVPz3psh_9VkzYSc/exec"; // sama URL

const data = JSON.parse(sessionStorage.getItem("statement_data")||"{}");
const ref = sessionStorage.getItem("statement_ref");

const box = document.getElementById("preview");
Object.keys(data).forEach(k=>{
  const div=document.createElement("div");
  div.className="row";
  div.innerHTML=`<b>${k.replaceAll("_"," ").toUpperCase()}:</b> ${data[k]}`;
  box.appendChild(div);
});

function viewPdf(){
  window.open(`${API_URL}?ref=${ref}&mode=view`,"_blank");
}
function downloadPdf(){
  const a=document.createElement("a");
  a.href=`${API_URL}?ref=${ref}&mode=download`;
  a.download=`STATEMENT_${ref}.pdf`;
  document.body.appendChild(a);a.click();a.remove();
}
</script>
</body>
</html>
