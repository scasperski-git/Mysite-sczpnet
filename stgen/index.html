<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DCA Statement System</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;font-family:Segoe UI,Arial;background:#020617;
  min-height:100vh;display:flex;align-items:center;justify-content:center;color:#e5e7eb;
}
.container{
  width:100%;max-width:760px;background:#020617;border-radius:18px;
  padding:28px;box-shadow:0 0 60px rgba(0,0,0,.7);border:1px solid #1e293b;
}
.form-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;}
label{font-size:11px;color:#94a3b8;}
input{
  width:100%;padding:10px;border-radius:10px;border:1px solid #334155;
  background:#020617;color:#e5e7eb;
}
.full{grid-column:1/-1;}
button{
  width:100%;padding:14px;border-radius:12px;border:none;
  background:linear-gradient(135deg,#16a34a,#22c55e);
  color:#022c22;font-weight:700;margin-top:18px;cursor:pointer;
}
</style>
</head>

<body>
<div class="container">
<h2 style="text-align:center">DCA Statement Generator</h2>

<div class="form-grid">
<div class="full"><label>Security Key</label><input id="key" type="password"></div>
<div><label>Customer Name</label><input id="customer_name"></div>
<div><label>IC Number</label><input id="ic"></div>
<div><label>Account No</label><input id="account_no"></div>
<div><label>Product</label><input id="product"></div>
<div><label>Agreement Date</label><input id="agreement_date" type="date"></div>
<div><label>Due Date</label><input id="due_date" type="date"></div>
<div><label>Outstanding</label><input id="outstanding"></div>
<div><label>Payable</label><input id="payable"></div>
<div><label>Valid Until</label><input id="valid_until" type="date"></div>
<div><label>Reference (Client)</label><input id="ref_client"></div>
<div class="full"><label>Letter Date</label><input id="letter_date" type="date"></div>
</div>

<button onclick="generate()">Generate Statement</button>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbySu1vJ3YbXiwl72RhT07GVA9jOrvqoSHhw-Gmnco0GWrOvPCRm9j9NsP6u9o0oHvBU/exec";  // <-- WAJIB PASTE URL WEB APP

function generate(){
  const fields = [
    "key","customer_name","ic","account_no","product",
    "agreement_date","due_date","outstanding","payable",
    "valid_until","ref_client","letter_date"
  ];

  const fd = new FormData();
  for(const f of fields){
    const el = document.getElementById(f);
    if(!el.value.trim()){
      alert("All fields required");
      return;
    }
    fd.append(f, el.value.trim());
  }

  fetch(API_URL,{method:"POST",body:fd})
    .then(r=>r.json())
    .then(j=>{
      if(j.status==="success"){
        const data = {};
        fields.filter(f=>f!=="key").forEach(f=>{
          data[f] = document.getElementById(f).value;
        });

        sessionStorage.setItem("statement_data", JSON.stringify(data));
        sessionStorage.setItem("statement_ref", j.ref);

        window.location.href = "view.html";
      }else{
        alert("INVALID KEY");
      }
    })
    .catch(err=>{
      console.log(err);
      alert("System error");
    });
}
</script>
</body>
</html>
