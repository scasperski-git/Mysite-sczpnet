<!DOCTYPE html>
<html>
<head>
  <base target="_top">
</head>
<body>
<h2>DCA Statement System</h2>
<form id="form">
<input name="rujukan" placeholder="Rujukan"><br>
<input name="tarikh" placeholder="Tarikh"><br>
<input name="nama" placeholder="Nama"><br>
<input name="ic" placeholder="No KP"><br>
<input name="akaun" placeholder="No Akaun"><br>
<input name="produk" placeholder="Produk"><br>
<input name="tarikh_perjanjian" placeholder="Tarikh Perjanjian"><br>
<input name="tarikh_akhir" placeholder="Tarikh Akhir Bayaran"><br>
<input name="tertunggak" placeholder="Jumlah Tertunggak"><br>
<input name="jumlah" placeholder="Jumlah Perlu Dibayar"><br>
<input name="sahlaku" placeholder="Sah Laku Hingga"><br><br>
<button type="submit">Submit & Generate</button>
</form>

<script>
const form = document.getElementById('form');
form.addEventListener('submit', e => {
  e.preventDefault();
  const data = Object.fromEntries(new FormData(form).entries());

  google.script.run.withSuccessHandler(res => {
    alert('SUCCESS! Data saved, PDF sent to email');
  }).submitData(data);
});
</script>
</body>
</html>
