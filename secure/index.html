<!DOCTYPE html>  
<html lang="en">  
<head>  
<meta charset="UTF-8">  
<link rel="icon" type="image/png" sizes="16x16" href="shield-neon-16.png">
<link rel="icon" type="image/png" sizes="32x32" href="shield-neon-32.png">
<link rel="apple-touch-icon" sizes="180x180" href="shield-neon-180.png">

<title>Secure Access Portal</title>  
<meta name="viewport" content="width=device-width, initial-scale=1.0">  
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">  
  
  
<style>  
*{box-sizing:border-box}  
  
body{  
  margin:0;  
  font-family:Segoe UI,Arial;  
  background:linear-gradient(135deg,#e6ebf2,#f1f5f9);  
  color:#0f172a;  
  min-height:100vh;  
  display:flex;  
  align-items:center;  
  justify-content:center;  
  zoom:0.9;   /* ðŸ”¥ Chrome fit fix */
}  
  
/* Animated container */  
.container{  
  width:100%;  
  max-width:460px;  
  background:#f8fafc;  
  border-radius:16px;  
  box-shadow:0 20px 40px rgba(0,0,0,.15);  
  overflow:hidden;  
  border:1px solid #cbd5e1;  
  animation:cardIn .6s ease;  
}  
  
@keyframes cardIn{  
  from{opacity:0;transform:translateY(30px) scale(.98)}  
  to{opacity:1;transform:translateY(0) scale(1)}  
}  
  
/* Header */  
.header{  
  padding:18px;  
  text-align:center;  
  background:linear-gradient(135deg,#0f172a,#1e293b);  
  color:#e5e7eb;  
}  
  
.header h2{margin:0;font-size:20px;font-weight:600}  
.header p{margin:6px 0 0;font-size:12px;color:#cbd5e1}  
  
/* Form */  
.form{padding:20px;animation:fadeIn .6s ease}  
@keyframes fadeIn{from{opacity:0}to{opacity:1}}  
  
label{font-size:11px;font-weight:600;color:#334155}  
  
.field{position:relative}  
  
input{  
  width:100%;  
  padding:11px 40px 11px 12px;  
  margin:6px 0 12px 0;  
  border-radius:10px;  
  border:1px solid #94a3b8;  
  background:#eef2f7;  
  font-size:13px;  
  color:#0f172a;  
  transition:.25s;  
}  
  
input:focus{  
  outline:none;  
  border-color:#2563eb;  
  background:#ffffff;  
  box-shadow:0 0 0 3px rgba(37,99,235,.15);  
}  
  
/* Reveal icon */  
.reveal-btn{  
  position:absolute;  
  right:12px;  
  top:50%;  
  transform:translateY(-50%);  
  font-size:16px;  
  cursor:pointer;  
  user-select:none;  
  opacity:.7;  
  transition:.2s;  
}  
.reveal-btn:hover{opacity:1;transform:translateY(-50%) scale(1.1)}  
  
  .reveal-btn i{  
  transition:.2s;  
}  
.reveal-btn:hover i{  
  transform:scale(1.15);  
}  
  
.fa-solid{  
  margin-right:6px;  
}  
  
/* Button */  
button{  
  width:100%;  
  padding:13px;  
  border-radius:12px;  
  border:none;  
  background:linear-gradient(135deg,#1e40af,#2563eb);  
  color:white;  
  font-weight:600;  
  font-size:14px;  
  cursor:pointer;  
  transition:.3s;  
  box-shadow:0 6px 16px rgba(37,99,235,.3);  
}  
button:hover{transform:translateY(-1px);box-shadow:0 10px 22px rgba(37,99,235,.4)}  
  
button.disabled{  
  background:#94a3b8 !important;  
  box-shadow:none !important;  
  cursor:not-allowed;  
  filter:blur(1px);  
}  
  
button.ready{  
  background:linear-gradient(135deg,#16a34a,#22c55e) !important;  
  box-shadow:0 8px 20px rgba(34,197,94,.4) !important;  
  filter:none;  
}  
  
/* Error message */  
.field-error{  
  font-size:10px;  
  color:#dc2626;  
  margin-top:6px;  
  display:none;  
  animation:shake .3s;  
}  
  
@keyframes shake{  
  0%{transform:translateX(0)}  
  25%{transform:translateX(-4px)}  
  50%{transform:translateX(4px)}  
  75%{transform:translateX(-4px)}  
  100%{transform:translateX(0)}  
}  
  
/* Consent */  
.consent{  
  font-size:11px;  
  color:#334155;  
  margin:8px 0 12px 0;  
  line-height:1.4;  
}  
 
/* Summary */  
.summary-box{  
  background:linear-gradient(135deg,#0f172a,#020617);  
  color:#e5e7eb;  
  border-radius:14px;  
  padding:18px;  
  animation:slideUp .6s ease;  
}  
  
@keyframes slideUp{  
  from{opacity:0;transform:translateY(25px)}  
  to{opacity:1;transform:translateY(0)}  
}  
  
.summary-box h4{text-align:center;margin-top:0;color:#22c55e}  
.summary-box p{font-size:12px;margin:6px 0}  
  
.pass{  
  font-size:20px;  
  color:#22c55e;  
  font-weight:bold;  
  text-align:center;  
  margin:10px 0;  
  letter-spacing:1px;  
}  
  
.consent-summary{  
  font-size:10px;  
  color:#cbd5e1;  
  background:#020617;  
  padding:10px;  
  border-radius:8px;  
  margin-top:10px;  
  border:1px solid #1e293b;  
}  

  /* ===== PREMIUM ICON INPUT UI ===== */
.icon-field{
  position:relative;
}

.icon-field .input-icon{
  position:absolute;
  left:14px;
  top:50%;
  transform:translateY(-50%);
  font-size:14px;
  color:#64748b;
  pointer-events:none;
  transition:.25s;
  z-index:2;
}

.icon-field input{
  padding-left:42px !important;
}

/* focus glow icon */
.icon-field:focus-within .input-icon{
  color:#2563eb;
  transform:translateY(-50%) scale(1.15);
  text-shadow:0 0 6px rgba(37,99,235,.4);
}

/* error state */
.icon-field input.input-error + .input-icon{
  color:#dc2626;
  text-shadow:0 0 6px rgba(220,38,38,.4);
}

/* success state (optional future use) */
.icon-field.valid .input-icon{
  color:#22c55e;
  text-shadow:0 0 6px rgba(34,197,94,.4);
}

/* secure hint under key */
.secure-hint{
  font-size:10px;
  color:#64748b;
  margin:-4px 0 8px 2px;
  display:flex;
  align-items:center;
  gap:6px;
}

.secure-hint i{
  color:#22c55e;
}

/* Animated security bar */
.security-bar{
  background:linear-gradient(90deg,#7c2d12,#ea580c,#7c2d12);
  color:#fff7ed;
  font-size:11px;
  padding:10px 14px;
  text-align:center;
  font-weight:600;
  position:relative;
  overflow:hidden;
  animation:slideDown .8s ease, pulseGlow 2.5s infinite;
  border-bottom:1px solid rgba(255,255,255,.2);
}

.security-bar i{
  margin-right:6px;
}

/* slide animation */
@keyframes slideDown{
  from{transform:translateY(-100%);opacity:0}
  to{transform:translateY(0);opacity:1}
}

/* glow pulse */
@keyframes pulseGlow{
  0%{box-shadow:0 0 0 rgba(234,88,12,0)}
  50%{box-shadow:0 0 18px rgba(234,88,12,.6)}
  100%{box-shadow:0 0 0 rgba(234,88,12,0)}
}

/* moving light effect */
.security-bar::after{
  content:"";
  position:absolute;
  top:0;
  left:-40%;
  width:40%;
  height:100%;
  background:linear-gradient(120deg,transparent,rgba(255,255,255,.25),transparent);
  animation:shine 3s infinite;
}

@keyframes shine{
  from{left:-40%}
  to{left:120%}
}
  
/* Success tick */  
.success-tick{  
  width:60px;height:60px;border-radius:50%;  
  border:3px solid #22c55e;  
  display:flex;align-items:center;justify-content:center;  
  margin:0 auto 10px auto;  
  animation:pop .5s ease;  
}  
.success-tick svg{  
  width:34px;height:34px;  
  stroke:#22c55e;stroke-width:4;fill:none;  
  stroke-dasharray:100;stroke-dashoffset:100;  
  animation:draw .8s ease forwards;  
}  
@keyframes draw{to{stroke-dashoffset:0}}  
@keyframes pop{0%{transform:scale(.5);opacity:0}100%{transform:scale(1);opacity:1}}  
  
/* Footer */  
.trademark{  
  text-align:center;  
  font-size:10px;  
  color:#475569;  
  padding:10px;  
  border-top:1px solid #cbd5e1;  
  background:#e2e8f0;  
}  
  
/* Loading */  
.loading{  
  position:fixed;  
  top:0;left:0;right:0;bottom:0;  
  background:rgba(15,23,42,.85);  
  display:flex;  
  align-items:center;  
  justify-content:center;  
  flex-direction:column;  
  z-index:999;  
  display:none;  
}  
  
  .input-error{  
  border-color:#dc2626 !important;  
  box-shadow:0 0 0 2px rgba(220,38,38,.2) !important;  
  animation:fieldShake .3s;  
}  
  
@keyframes fieldShake{  
  0%{transform:translateX(0)}  
  25%{transform:translateX(-4px)}  
  50%{transform:translateX(4px)}  
  75%{transform:translateX(-4px)}  
  100%{transform:translateX(0)}  
}  
  
.field-msg{  
  font-size:10px;  
  color:#dc2626;  
  margin-top:-6px;  
  margin-bottom:6px;  
  display:none;  
}  

  /* ===== ENTERPRISE PREMIUM SUCCESS ===== */

.success-premium{
  position:relative;
  width:90px;
  height:90px;
  margin:0 auto 14px auto;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* glow halo */
.success-halo{
  position:absolute;
  width:100%;
  height:100%;
  border-radius:50%;
  background:radial-gradient(circle, rgba(34,197,94,.35), transparent 70%);
  animation:haloPulse 2.5s infinite;
  z-index:0;
}

/* rotating ring */
.success-ring-premium{
  position:absolute;
  width:100%;
  height:100%;
  border-radius:50%;
  animation:ringRotate 2.8s linear infinite;
  z-index:1;
}

.success-ring-premium svg{
  width:100%;
  height:100%;
}

.success-ring-premium circle{
  fill:none;
  stroke:rgba(34,197,94,.45);
  stroke-width:2;
  stroke-dasharray:10 8;
}

/* core circle */
.success-core-premium{
  width:62px;
  height:62px;
  border-radius:50%;
  background:#020617;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:2;
  box-shadow:0 0 25px rgba(34,197,94,.45);
  animation:corePop .6s ease;
}

/* tick */
.success-core-premium svg{
  width:30px;
  height:30px;
  stroke:#22c55e;
  stroke-width:4;
  fill:none;
  stroke-dasharray:100;
  stroke-dashoffset:100;
  animation:drawTick .9s ease forwards .4s;
}

/* ===== Animations ===== */

@keyframes haloPulse{
  0%{transform:scale(.9);opacity:.4}
  50%{transform:scale(1.05);opacity:.7}
  100%{transform:scale(.9);opacity:.4}
}

@keyframes ringRotate{
  from{transform:rotate(0deg)}
  to{transform:rotate(360deg)}
}

@keyframes corePop{
  0%{transform:scale(.4);opacity:0}
  100%{transform:scale(1);opacity:1}
}

@keyframes drawTick{
  to{stroke-dashoffset:0}
}
/* ===== ENTERPRISE PREMIUM INVALID ===== */

.invalid-premium{
  position:relative;
  width:90px;
  height:90px;
  margin:0 auto 14px auto;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* red halo */
.invalid-halo{
  position:absolute;
  width:100%;
  height:100%;
  border-radius:50%;
  background:radial-gradient(circle, rgba(220,38,38,.35), transparent 70%);
  animation:haloPulseRed 2.2s infinite;
  z-index:0;
}

/* rotating ring */
.invalid-ring-premium{
  position:absolute;
  width:100%;
  height:100%;
  border-radius:50%;
  animation:ringRotateReverse 2.5s linear infinite;
  z-index:1;
}

.invalid-ring-premium svg{
  width:100%;
  height:100%;
}

.invalid-ring-premium circle{
  fill:none;
  stroke:rgba(239,68,68,.45);
  stroke-width:2;
  stroke-dasharray:10 8;
}

/* core */
.invalid-core-premium{
  width:62px;
  height:62px;
  border-radius:50%;
  background:#020617;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:2;
  box-shadow:0 0 25px rgba(220,38,38,.45);
  animation:corePopRed .6s ease;
}

/* cross */
.invalid-core-premium svg{
  width:30px;
  height:30px;
  stroke:#ef4444;
  stroke-width:4;
  fill:none;
  stroke-dasharray:120;
  stroke-dashoffset:120;
  animation:drawCross .8s ease forwards .4s;
}

/* ===== Animations ===== */

@keyframes haloPulseRed{
  0%{transform:scale(.9);opacity:.4}
  50%{transform:scale(1.05);opacity:.7}
  100%{transform:scale(.9);opacity:.4}
}

@keyframes ringRotateReverse{
  from{transform:rotate(0deg)}
  to{transform:rotate(-360deg)}
}

@keyframes corePopRed{
  0%{transform:scale(.4);opacity:0}
  100%{transform:scale(1);opacity:1}
}

@keyframes drawCross{
  to{stroke-dashoffset:0}
}


  /* ===== PREMIUM CONSENT UI ===== */
.consent-box{
  margin:10px 0 14px 0;
}

.consent-ui{
  display:flex;
  align-items:flex-start;
  gap:10px;
  cursor:pointer;
  user-select:none;
  font-size:11px;
  color:#334155;
  line-height:1.5;
  position:relative;
}

.consent-ui input{
  display:none;
}

/* box */
.checkmark{
  width:18px;
  height:18px;
  min-width:18px;
  border-radius:6px;
  border:2px solid #94a3b8;
  background:#f1f5f9;
  display:flex;
  align-items:center;
  justify-content:center;
  transition:.25s;
  box-shadow:inset 0 0 0 rgba(0,0,0,0);
}

/* tick icon */
.checkmark::after{
  content:"";
  width:6px;
  height:10px;
  border-right:3px solid white;
  border-bottom:3px solid white;
  transform:rotate(45deg) scale(0);
  transition:.25s;
}

/* checked */
.consent-ui input:checked + .checkmark{
  background:linear-gradient(135deg,#16a34a,#22c55e);
  border-color:#22c55e;
  box-shadow:0 0 0 4px rgba(34,197,94,.15);
}

.consent-ui input:checked + .checkmark::after{
  transform:rotate(45deg) scale(1);
}

/* hover */
.consent-ui:hover .checkmark{
  border-color:#2563eb;
}
  
.spinner{  
  width:42px;height:42px;  
  border:4px solid #334155;  
  border-top:4px solid #38bdf8;  
  border-radius:50%;  
  animation:spin 1s linear infinite;  
}  

/* ===== PREMIUM SUCCESS TICK ===== */
.success-ring{
  width:72px;
  height:72px;
  border-radius:50%;
  background:conic-gradient(from 0deg,#22c55e,#16a34a,#22c55e);
  display:flex;
  align-items:center;
  justify-content:center;
  margin:0 auto 12px auto;
  animation:ringSpin 1.2s ease;
  box-shadow:0 0 25px rgba(34,197,94,.45);
}

.success-core{
  width:56px;
  height:56px;
  border-radius:50%;
  background:#020617;
  display:flex;
  align-items:center;
  justify-content:center;
}

.success-core svg{
  width:30px;
  height:30px;
  stroke:#22c55e;
  stroke-width:4;
  fill:none;
  stroke-dasharray:100;
  stroke-dashoffset:100;
  animation:drawTick .9s ease forwards .4s;
}

  /* ===== PREMIUM INVALID CROSS ===== */
.invalid-ring{
  width:72px;
  height:72px;
  border-radius:50%;
  background:conic-gradient(from 0deg,#dc2626,#7f1d1d,#dc2626);
  display:flex;
  align-items:center;
  justify-content:center;
  margin:0 auto 12px auto;
  animation:ringSpinRed 1.2s ease;
  box-shadow:0 0 25px rgba(220,38,38,.45);
}

.invalid-core{
  width:56px;
  height:56px;
  border-radius:50%;
  background:#020617;
  display:flex;
  align-items:center;
  justify-content:center;
}

.invalid-core svg{
  width:30px;
  height:30px;
  stroke:#ef4444;
  stroke-width:4;
  fill:none;
  stroke-dasharray:120;
  stroke-dashoffset:120;
  animation:drawCross .8s ease forwards .4s;
}

/* animations */
@keyframes ringSpinRed{
  0%{transform:scale(.4) rotate(180deg);opacity:0}
  100%{transform:scale(1) rotate(0deg);opacity:1}
}

@keyframes drawCross{
  to{stroke-dashoffset:0}
}


/* animations */
@keyframes ringSpin{
  0%{transform:scale(.4) rotate(-180deg);opacity:0}
  100%{transform:scale(1) rotate(0deg);opacity:1}
}

@keyframes drawTick{
  to{stroke-dashoffset:0}
}

@keyframes spin{to{transform:rotate(360deg)}}  
  
.loading p{margin-top:10px;font-size:12px;color:#e5e7eb}  
.hidden{display:none}  
  
@media(max-width:600px){  
  .container{margin:10px;border-radius:14px;}  
}  
  @media (min-width:1200px){
  body{ zoom:0.9; }
}

@media (min-width:1400px){
  body{ zoom:0.85; }
}


  /* ===== SYSTEM OFF MODE ===== */

.system-off{
  position:fixed;
  inset:0;
  background:radial-gradient(circle at top,#020617,#000000);
  z-index:9999;
  display:flex;
  align-items:center;
  justify-content:center;
}

.system-off.hidden{
  display:none;
}

.off-card{
  background:rgba(2,6,23,.85);
  border:1px solid #1e293b;
  border-radius:20px;
  padding:40px 34px;
  max-width:420px;
  width:90%;
  text-align:center;
  box-shadow:0 0 60px rgba(0,0,0,.8);
  animation:fadePop .8s ease;
  backdrop-filter: blur(10px);
}

.off-icon{
  width:90px;
  height:90px;
  border-radius:50%;
  margin:0 auto 18px auto;
  display:flex;
  align-items:center;
  justify-content:center;
  background:radial-gradient(circle,#1e293b,#020617);
  box-shadow:0 0 30px rgba(56,189,248,.15);
  animation:pulseGlowBlue 2.5s infinite;
}

.off-icon i{
  font-size:38px;
  color:#38bdf8;
  text-shadow:0 0 20px rgba(56,189,248,.6);
}

.off-card h2{
  margin:10px 0 8px 0;
  color:#e5e7eb;
  font-size:20px;
  font-weight:600;
}

.off-card p{
  font-size:13px;
  color:#94a3b8;
  margin-bottom:16px;
}

.off-sub{
  font-size:11px;
  color:#cbd5e1;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  background:#020617;
  padding:10px;
  border-radius:10px;
  border:1px solid #1e293b;
}

  .off-icon{
  background:radial-gradient(circle,#3f1d1d,#020617);
  box-shadow:0 0 35px rgba(239,68,68,.35);
}

.off-icon i{
  color:#ef4444;
  text-shadow:0 0 20px rgba(239,68,68,.6);
}


/* animations */
@keyframes fadePop{
  0%{opacity:0;transform:scale(.85)}
  100%{opacity:1;transform:scale(1)}
}

@keyframes pulseGlowBlue{
  0%{box-shadow:0 0 0 rgba(56,189,248,0)}
  50%{box-shadow:0 0 30px rgba(56,189,248,.35)}
  100%{box-shadow:0 0 0 rgba(56,189,248,0)}
}

</style>
  <script>
/* ===== SYSTEM MODE CONFIG ===== */
const SYSTEM_MODE = "ON"; 
// "ON"  = normal operation
// "OFF" = restricted mode
</script>

 </head>  
  
<body>  

  <div id="systemOffOverlay" class="system-off hidden">
  <div class="off-card">
    <div class="off-icon">
      <i class="fa-solid fa-road-barrier"></i>     <!-- barrier icon -->
    </div>

    <h2>System Locked</h2>
<p>Secure services are currently disabled.</p>
<div class="off-sub">
  <i class="fa-solid fa-shield-halved"></i>
  Controlled by system security authority.
</div>
  </div>
</div>

  
<div class="loading" id="loading">  
  <div class="spinner"></div>  
  <p>Verifying secure access...</p>  
</div>  
  
<div class="container">  
  <div class="header">  
    <h2><i class="fa-solid fa-lock"></i> Secure Password Access</h2>  
    <p>Authorized Agency Portal</p>  
  </div>  
  
  <div class="security-bar">
  <i class="fa-solid fa-triangle-exclamation"></i>
  This security key is for <b>authorized use only</b>. Any disclosure is the <b>full responsibility of the key holder</b>. Data is <b>highly sensitive</b> and subject to audit.
  </div>
  
  <div class="form" id="step1">  
    <label>Agency Full Name</label>  
<div class="field icon-field">
  <i class="fa-solid fa-building input-icon"></i>
  <input id="agency" placeholder="e.g ABC DEBT COLLECTION SDN BHD">  
</div>
<div class="field-msg" id="errAgency">Agency Full Name is required</div>  
  
    <label>Director Name</label>  
<div class="field icon-field">
  <i class="fa-solid fa-user-tie input-icon"></i>
  <input id="director" placeholder="e.g JOHN DOE">  
</div>
<div class="field-msg" id="errDirector">Director Name is required</div>  

  
<label>Contact Number</label>  
<div class="field icon-field">
  <i class="fa-solid fa-phone input-icon"></i>
  <input   
    id="contact"   
    placeholder="e.g 012-3456789"  
    type="tel"  
    inputmode="numeric"  
    pattern="[0-9]*"  
    maxlength="12"  
  >  
</div>
<div class="field-msg" id="errContact">Contact Number is required</div>  
<div id="errPhone" style="font-size:10px;color:#dc2626;display:none;margin-top:-8px;margin-bottom:8px;"></div>  

  
 <label>Security Key</label>  
<!-- ===== Password Manager Trap Fields ===== -->
<input type="text" style="display:none">
<input type="password" style="display:none">

<!-- ===== REAL SECURITY KEY FIELD ===== -->
<div class="field icon-field">  
  <i class="fa-solid fa-key input-icon"></i>

  <input 
    id="key"
    type="password"
    placeholder="Enter your security key"
    autocomplete="off"
    name="secure_access_token_94731"
    autocorrect="off"
    autocapitalize="off"
    spellcheck="false"
  >  

  <span class="reveal-btn" onclick="toggleKey()" id="revealIcon">  
    <i class="fa-solid fa-eye"></i>  
  </span>  
</div>  



<div class="secure-hint">
  <i class="fa-solid fa-shield-halved"></i>
  Encrypted secure input
</div>

<div class="field-msg" id="errKey">Security key is required</div>  

  
    <div class="consent-box">
  <label class="consent-ui">
    <input type="checkbox" id="consent">
    <span class="checkmark"></span>
    <span class="consent-text">
      I hereby confirm that I am an authorized representative of the agency and agree that all access activities will be logged for security, audit and compliance purposes.
    </span>
  </label>
</div>
  
    <button id="submitBtn" class="disabled" onclick="verifyKey()">Request Secure Password</button>  
    <div class="field-error" id="formError">All fields are required</div>  
  </div>  
  
  <div class="form hidden" id="step2">  
    <div class="summary-box" id="successBox">
      <div class="success-premium">
  <div class="success-halo"></div>

  <div class="success-ring-premium">
    <svg viewBox="0 0 100 100">
      <circle cx="50" cy="50" r="45"></circle>
    </svg>
  </div>

  <div class="success-core-premium">
    <svg viewBox="0 0 52 52">
      <path d="M14 27 L23 36 L38 16"></path>
    </svg>
  </div>
</div>

      <h4>Access Approved</h4>  
      <!-- âŒ Reference No -->
      <p style="text-align:center;font-size:11px;color:#94a3b8;margin-top:6px;">
      Reference No: <b id="refSuccess"></b>
      </p>
  
      <p><b>Agency:</b> <span id="sAgency"></span></p>  
      <p><b>Director:</b> <span id="sDirector"></span></p>  
      <p><b>Contact:</b> <span id="sContact"></span></p>  
  
      <hr style="border:0;border-top:1px solid #334155;margin:10px 0;">  
      <p style="text-align:center;font-size:12px">Assigned System Password</p>  
      <div class="pass" id="sPassword"></div>  
  
      <div class="consent-summary" id="sConsentText"></div>  
    </div>  
      
     <div class="summary-box hidden" id="invalidBox">  

 <div class="invalid-premium">
  <div class="invalid-halo"></div>

  <div class="invalid-ring-premium">
    <svg viewBox="0 0 100 100">
      <circle cx="50" cy="50" r="45"></circle>
    </svg>
  </div>

  <div class="invalid-core-premium">
    <svg viewBox="0 0 52 52">
      <path d="M16 16 L36 36"></path>
      <path d="M36 16 L16 36"></path>
    </svg>
  </div>
</div>


  
  <h4 style="color:#ef4444;text-align:center;">Access Denied</h4>  
  
  <p style="text-align:center;font-size:12px;color:#fca5a5;">  
    Invalid Security Key Detected  
  </p>  
  
  <hr style="border:0;border-top:1px solid #334155;margin:10px 0;">  
  
  <p><b>Agency:</b> <span id="iAgency"></span></p>  
  <p><b>Director:</b> <span id="iDirector"></span></p>  
  <p><b>Contact:</b> <span id="iContact"></span></p>  

  <!-- âŒ Reference No -->
  <p style="text-align:center;font-size:11px;color:#fca5a5;margin-top:6px;">
    Reference No: <b id="refInvalid"></b>
  </p>
  
  <div class="consent-summary" style="border-color:#7f1d1d;background:#020617;">  
    âš  Security Alert:<br>  
    The security key provided is invalid.    
    This access attempt has been logged for audit and compliance monitoring.    
    Please verify your credentials or contact system administrator.  
  </div>  
     </div>  
      
  </div>  
  
  <div class="trademark">  
    Â© 2026 Secure Access Systemâ„¢ Â· All Rights Reserved Â· Unauthorized access is prohibited  
  </div>  
</div> 

  <script>  
const API_URL = "https://script.google.com/macros/s/AKfycbyBqIlWQMg9RXmMW3uaXRF-wPg2uE9NqQhycDFCA_MHEQpTE1q8GTpHbsaLn7VxSwa10w/exec";  
  
const agencyEl = document.getElementById('agency');  
const directorEl = document.getElementById('director');  
const contactEl = document.getElementById('contact');  
const keyEl = document.getElementById('key');  
const submitBtn = document.getElementById('submitBtn');  
const formError = document.getElementById('formError');  
const step1 = document.getElementById('step1');  
const step2 = document.getElementById('step2');  
const sAgency = document.getElementById('sAgency');  
const sDirector = document.getElementById('sDirector');  
const sContact = document.getElementById('sContact');  
const sPassword = document.getElementById('sPassword');  
const sConsentText = document.getElementById('sConsentText');  
const loading = document.getElementById('loading');  
  
/* Auto caps */  
function autoCaps(el){ el.value = el.value.toUpperCase(); }  
agencyEl.addEventListener("input",()=>autoCaps(agencyEl));  
directorEl.addEventListener("input",()=>autoCaps(directorEl));  
  
/* Reveal key */  
let hideTimer=null;  
  
function toggleKey(){  
  const icon = document.querySelector("#revealIcon i");  
  
  if(keyEl.type==="password"){  
    keyEl.type="text";  
    icon.classList.remove("fa-eye");  
    icon.classList.add("fa-eye-slash");  
  
    clearTimeout(hideTimer);  
    hideTimer=setTimeout(()=>{  
      keyEl.type="password";  
      icon.classList.remove("fa-eye-slash");  
      icon.classList.add("fa-eye");  
    },10000);  
  
  }else{  
    keyEl.type="password";  
    icon.classList.remove("fa-eye-slash");  
    icon.classList.add("fa-eye");  
    clearTimeout(hideTimer);  
  }  
}  
  
  
/* Form validation state */  
function checkForm(){  
  const consent=document.getElementById('consent').checked;  
  if(agencyEl.value && directorEl.value && contactEl.value && keyEl.value && consent){  
    submitBtn.classList.remove("disabled");  
    submitBtn.classList.add("ready");  
    formError.style.display="none";  
  }else{  
    submitBtn.classList.add("disabled");  
    submitBtn.classList.remove("ready");  
  }  
}  
  
["input","change"].forEach(evt=>{  
  agencyEl.addEventListener(evt,checkForm);  
  directorEl.addEventListener(evt,checkForm);  
  contactEl.addEventListener(evt,checkForm);  
  keyEl.addEventListener(evt,checkForm);  
  document.getElementById("consent").addEventListener(evt,checkForm);  
});  
  
const phoneInput = document.getElementById("contact");
const err = document.getElementById("errPhone");

/* ===== STRICT MALAYSIA PHONE FORMAT ===== */
phoneInput.addEventListener("input", function () {

  // Remove everything except numbers
  let raw = this.value.replace(/\D/g, "");

  // Hard limit digits
  if (raw.length > 11) raw = raw.slice(0, 11);

  // Validation rules
  if (raw.length > 0 && !raw.startsWith("0")) {
    err.innerText = "Number must start with 0";
    err.style.display = "block";
  } else {
    err.style.display = "none";
  }

  let formatted = raw;

  /* MOBILE */
  if (raw.startsWith("01")) {
    if (raw.length >= 4) {
      formatted = raw.slice(0, 3) + "-" + raw.slice(3);
    }
  }

  /* LANDLINE */
  else if (raw.startsWith("0")) {
    if (raw.length >= 3) {
      formatted = raw.slice(0, 2) + "-" + raw.slice(2);
    }
  }

  this.value = formatted;
});

/* ===== BLOCK INVALID INPUT ===== */
phoneInput.addEventListener("keypress", function(e){
  if(!/[0-9]/.test(e.key)){
    e.preventDefault();
  }
});

/* ===== BLOCK PASTE JUNK ===== */
phoneInput.addEventListener("paste", function(e){
  e.preventDefault();
  let paste = (e.clipboardData || window.clipboardData).getData("text");
  let digits = paste.replace(/\D/g,"").slice(0,11);
  this.value = digits.startsWith("0")
    ? (digits.startsWith("01") && digits.length > 3
        ? digits.slice(0,3)+"-"+digits.slice(3)
        : digits.slice(0,2)+"-"+digits.slice(2))
    : "";
});
  
  const consentEl = document.getElementById("consent");  
  
function validateFields(){  
  let ok = true;  
  
  function check(el, errEl){  
    if(!el.value.trim()){  
      el.classList.add("input-error");  
      errEl.style.display="block";  
      ok = false;  
    }else{  
      el.classList.remove("input-error");  
      errEl.style.display="none";  
    }  
  }  
  
  check(agencyEl, document.getElementById("errAgency"));  
  check(directorEl, document.getElementById("errDirector"));  
  check(contactEl, document.getElementById("errContact"));  
  check(keyEl, document.getElementById("errKey"));  
  
  return ok;  
}  
  
/* Trigger on consent tick */  
consentEl.addEventListener("change", ()=>{  
  if(consentEl.checked){  
    validateFields();  
  }  
});  
  
  function clearError(el, errId){  
  el.classList.remove("input-error");  
  document.getElementById(errId).style.display="none";  
}  
  
agencyEl.addEventListener("input",()=>clearError(agencyEl,"errAgency"));  
directorEl.addEventListener("input",()=>clearError(directorEl,"errDirector"));  
contactEl.addEventListener("input",()=>clearError(contactEl,"errContact"));  
keyEl.addEventListener("input",()=>clearError(keyEl,"errKey"));  

let USER_IP = "-";
let USER_GEO = {};

fetch("https://ipapi.co/json/")
  .then(r=>r.json())
  .then(d=>{
    USER_IP = d.ip || "-";
    USER_GEO = {
      country: d.country_name,
      region: d.region,
      city: d.city,
      lat: d.latitude,
      lon: d.longitude
    };
  })
  .catch(()=>{});
    
/* Submit */  
function verifyKey(){  
  
  if(submitBtn.classList.contains("disabled")){  
    formError.style.display="block";  
    formError.style.animation="none";  
    formError.offsetHeight;  
    formError.style.animation="shake .3s";  
    return;  
  }  
  
  loading.style.display="flex";  

 fetch(`${API_URL}?action=direct_access`
  + `&agency=${encodeURIComponent(agencyEl.value)}`
  + `&key=${encodeURIComponent(keyEl.value)}`
  + `&director=${encodeURIComponent(directorEl.value)}`
  + `&contact=${encodeURIComponent(contactEl.value)}`
  + `&ip=${encodeURIComponent(USER_IP || "-")}`
  + `&geo=${encodeURIComponent(JSON.stringify(USER_GEO || {}))}`
  + `&consent=${encodeURIComponent(document.querySelector(".consent-text").innerText)}`
)

  .then(res=>res.json())  
  .then(data=>{  
    loading.style.display="none";  

    document.querySelector(".security-bar").style.display = "none";

    step1.classList.add('hidden');  
    step2.classList.remove('hidden');  
  
// ===== INVALID =====  
if(data.status !== "success"){  

  successBox.classList.add("hidden");
  invalidBox.classList.remove("hidden");

  document.getElementById("iAgency").innerText = agencyEl.value;  
  document.getElementById("iDirector").innerText = directorEl.value;  
  document.getElementById("iContact").innerText = contactEl.value;  

  // ref from server
  document.getElementById("refInvalid").innerText = data.ref || "-";

  return;  
}  

// ===== SUCCESS =====  
invalidBox.classList.add("hidden");
successBox.classList.remove("hidden");

// ref from server
document.getElementById("refSuccess").innerText = data.ref || "-";

    sAgency.innerText = agencyEl.value;  
    sDirector.innerText = directorEl.value;  
    sContact.innerText = contactEl.value;  

    // ===== DYNAMIC PASSWORD RENDER =====  
    let output = "";  
  
    if(data.assignment){  
      output += `ASSIGNMENT PASSWORD:\n${data.assignment}\n\n`;  
    }  
    if(data.scheme_npl){  
      output += `NPL SCHEME PASSWORD:\n${data.scheme_npl}\n\n`;  
    }  
    if(data.scheme_jv){  
      output += `JV SCHEME PASSWORD:\n${data.scheme_jv}\n\n`;  
    }  
    if(data.extra){  
      output += `EXTRA PASSWORD:\n${data.extra}\n\n`;  
    }  
  
    sPassword.innerText = output.trim();  
  
    sConsentText.innerText =  
      "Consent Declaration: I hereby confirm that I am an authorized representative of the agency and agree that all access activities will be logged for security, audit and compliance purposes.";  
  })
  .catch(err=>{
    console.error("API ERROR:", err);
    loading.style.display="none";
    alert("System error. Please try again or contact administrator.");
  });
}
    /* ===== SYSTEM MODE HANDLER ===== */
(function(){
  if(SYSTEM_MODE === "OFF"){
    document.getElementById("systemOffOverlay").classList.remove("hidden");
  }
})();

  
</script>  
  
</body>  
</html>
